<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ–æ—Ä–∏—è –∏–≥—Ä: –õ–∏—á–Ω—ã–π –≤—ã–±–æ—Ä</title>
    <style>
        :root {
            --bg-dark: #2d2d2d;
            --bg-panel: #3a3a3a;
            --accent-yellow: #fff3cd;
            --text-white: #f8f9fa;
            --progress-green: #a9d07d;
            --pleasure-short: #c8a063;
            --pleasure-long: #f6e09d;
            --stress-red: #df928c;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-white);
            margin: 0;
            padding: 10px;
            min-height: 100vh;
            display: grid;
            grid-template-rows: auto 1fr;
            gap: 10px;
            overflow: hidden;
        }
        
        h1, h2, h3 {
            color: var(--accent-yellow);
            margin: 5px 0;
            font-size: 1.2em;
        }
        
        .container {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 10px;
            height: calc(100vh - 60px);
        }
        
        .panel {
            background-color: var(--bg-panel);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .stats-panel {
            gap: 8px;
        }
        
        .day-info {
            background-color: rgba(0, 0, 0, 0.2);
            padding: 8px;
            border-radius: 6px;
            margin-bottom: 10px;
        }
        
        .strategies {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .strategy-card {
            background-color: rgba(0, 0, 0, 0.1);
            padding: 8px;
            border-radius: 6px;
            border-left: 3px solid var(--accent-yellow);
            font-size: 0.9em;
        }
        
        select {
            width: 100%;
            padding: 5px;
            margin: 5px 0;
            background-color: var(--bg-dark);
            color: var(--text-white);
            border: 1px solid var(--accent-yellow);
            border-radius: 3px;
            font-size: 0.8em;
        }
        
        .matrix {
            background-color: rgba(0, 0, 0, 0.1);
            padding: 8px;
            border-radius: 6px;
            margin-bottom: 10px;
            font-size: 0.8em;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.75em;
        }
        
        th, td {
            padding: 6px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 243, 205, 0.1);
        }
        
        th {
            color: var(--accent-yellow);
        }
        
        .choices {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        button {
            padding: 8px;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.8em;
        }
        
        .cooperate {
            background-color: var(--progress-green);
            color: #000;
        }
        
        .betray {
            background-color: var(--pleasure-short);
            color: #000;
        }
        
        .metric {
            margin-bottom: 8px;
        }
        
        .metric-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 3px;
            font-size: 0.8em;
        }
        
        .bar-bg {
            height: 15px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .bar-fill {
            height: 100%;
            border-radius: 8px;
            transition: width 0.3s;
        }
        
        .progress-bar {
            background-color: var(--progress-green);
        }
        
        .pleasure-long-bar {
            background-color: var(--pleasure-long);
        }
        
        .pleasure-short-bar {
            background-color: var(--pleasure-short);
        }
        
        .stress-bar {
            background-color: var(--stress-red);
        }
        
        .history {
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .history-content {
            flex: 1;
            overflow: hidden;
            font-size: 0.75em;
        }
        
        .history-item {
            padding: 5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            line-height: 1.3;
        }

    /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞–≤–ª—è–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ: */
    
    .container {
        display: grid;
        grid-template-columns: 280px 1fr; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏ */
        gap: 10px;
        height: calc(100vh - 60px);
    }
    
    .stats-panel {
        gap: 6px; /* –£–º–µ–Ω—å—à–∞–µ–º –ø—Ä–æ–º–µ–∂—É—Ç–∫–∏ */
        padding: 10px; /* –ú–µ–Ω—å—à–µ –æ—Ç—Å—Ç—É–ø—ã */
    }
    
    .metric {
        margin-bottom: 6px; /* –£–º–µ–Ω—å—à–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã –º–µ–∂–¥—É –º–µ—Ç—Ä–∏–∫–∞–º–∏ */
    }
    
    .metric-label {
        font-size: 0.7em; /* –ú–µ–Ω—å—à–∏–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ */
    }
    
    .bar-bg {
        height: 12px; /* –¢–æ–Ω–∫–∏–µ –ø–æ–ª–æ—Å–∫–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ */
    }
    
    h3 {
        margin: 3px 0; /* –ú–µ–Ω—å—à–∏–µ –æ—Ç—Å—Ç—É–ø—ã —É –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ */
        font-size: 1em;
    }
    
    .history-item {
        padding: 3px;
        font-size: 0.65em; /* –ú–µ–Ω—å—à–∏–π —à—Ä–∏—Ñ—Ç –∏—Å—Ç–æ—Ä–∏–∏ */
        line-height: 1.2;
    }
    </style>
</head>
<body>
    <h1>–¢–µ–æ—Ä–∏—è –∏–≥—Ä: –õ–∏—á–Ω—ã–π –≤—ã–±–æ—Ä</h1>
    
    <div class="container">
        <div class="panel stats-panel">
            <h2>–î–µ–Ω—å <span id="current-day">1</span>/30</h2>
            <div class="bar-bg">
                <div class="bar-fill progress-bar" id="day-progress-bar" style="width: 3.3%;"></div>
            </div>
            
            <h3>–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h3>
            <div class="metric">
                <div class="metric-label">
                    <span>–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                    <span id="progress-value">20</span>
                </div>
                <div class="bar-bg">
                    <div class="bar-fill progress-bar" id="progress-bar" style="width: 20%;"></div>
                </div>
            </div>
            
            <div class="metric">
                <div class="metric-label">
                    <span>–£–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ (–¥–æ–ª–≥.)</span>
                    <span id="pleasure-long-value">10</span>
                </div>
                <div class="bar-bg">
                    <div class="bar-fill pleasure-long-bar" id="pleasure-long-bar" style="width: 10%;"></div>
                </div>
            </div>
            
            <div class="metric">
                <div class="metric-label">
                    <span>–£–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ (–∫—Ä–∞—Ç–∫.)</span>
                    <span id="pleasure-short-value">30</span>
                </div>
                <div class="bar-bg">
                    <div class="bar-fill pleasure-short-bar" id="pleasure-short-bar" style="width: 30%;"></div>
                </div>
            </div>
            
            <div class="metric">
                <div class="metric-label">
                    <span>–°—Ç—Ä–µ—Å—Å</span>
                    <span id="stress-value">20</span>
                </div>
                <div class="bar-bg">
                    <div class="bar-fill stress-bar" id="stress-bar" style="width: 20%;"></div>
                </div>
            </div>
            
            <h3 style="margin-top: 8px;">–ò—Å—Ç–æ—Ä–∏—è</h3>
            <div class="history">
                <div class="history-content" id="history">
                    <!-- –ò—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
        
        <div class="panel game-panel" id="game-panel">
            <div class="day-info">
                <h2>–î–µ–Ω—å <span id="day">1</span></h2>
                <p style="font-size: 0.8em; margin: 3px 0;">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏ –¥–µ–π—Å—Ç–≤–∏–µ</p>
            </div>
            
            <div class="strategies">
                <div class="strategy-card">
                    <h3>ü§ì –ë–ª–∞–≥–æ—Ä–∞–∑—É–º–∏–µ</h3>
                    <select id="wisdom-strategy">
                        <option value="tit-for-tat">Tit-for-Tat</option>
                        <option value="grudger">Grudger</option>
                    </select>
                    <p id="wisdom-desc" style="font-size: 0.7em; margin: 3px 0;">–ù–∞—á–∏–Ω–∞–µ—Ç —Å —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞, –ø–æ—Ç–æ–º –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –≤–∞—à –ø—Ä–æ—à–ª—ã–π –≤—ã–±–æ—Ä.</p>
                </div>
                <div class="strategy-card">
                    <h3>üòà –ü–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ</h3>
                    <select id="subconscious-strategy">
                        <option value="always-betray">Always Betray</option>
                        <option value="random">Random</option>
                        <option value="pavlov">Pavlov</option>
                    </select>
                    <p id="subconscious-desc" style="font-size: 0.7em; margin: 3px 0;">–í—Å–µ–≥–¥–∞ —É–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç –ª–µ–Ω–∏—Ç—å—Å—è.</p>
                </div>
            </div>
            
            <div class="matrix">
                <h3>–ú–∞—Ç—Ä–∏—Ü–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π</h3>
                <table id="outcome-matrix">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ–º–∞—è –º–∞—Ç—Ä–∏—Ü–∞ -->
                </table>
            </div>
            
            <div class="choices">
                <button class="cooperate" id="cooperate">–£—á–µ–±–∞</button>
                <button class="betray" id="betray">–õ–µ–Ω—å</button>
            </div>
        </div>
    </div>

    <script>
        // –ò–≥—Ä–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        const gameState = {
            day: 1,
            maxDays: 30,
            progress: 20,
            pleasureLong: 10,
            pleasureShort: 30,
            stress: 20,
            lastChoice: null,
            wisdomStrategy: 'tit-for-tat',
            subconsciousStrategy: 'always-betray',
            history: [],
            hasBetrayed: false
        };

        // –û–ø–∏—Å–∞–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
        const strategyDescriptions = {
            wisdom: {
                'tit-for-tat': '–ù–∞—á–∏–Ω–∞–µ—Ç —Å —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞, –ø–æ—Ç–æ–º –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –≤–∞—à –ø—Ä–æ—à–ª—ã–π –≤—ã–±–æ—Ä.',
                'grudger': '–°–æ—Ç—Ä—É–¥–Ω–∏—á–∞–µ—Ç, –ø–æ–∫–∞ –≤—ã –Ω–µ –ø—Ä–µ–¥–∞–¥–∏—Ç–µ ‚Äî –ø–æ—Ç–æ–º –≤—Å–µ–≥–¥–∞ –Ω–∞–∫–∞–∑—ã–≤–∞–µ—Ç.'
            },
            subconscious: {
                'always-betray': '–í—Å–µ–≥–¥–∞ —É–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç –ª–µ–Ω–∏—Ç—å—Å—è.',
                'random': '–°–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞–µ—Ç –º–µ–∂–¥—É –¥–∞–≤–ª–µ–Ω–∏–µ–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π.',
                'pavlov': '–ï—Å–ª–∏ –≤—ã –ø–æ–¥–¥–∞–ª–∏—Å—å ‚Äî –¥–∞–≤–∏—Ç —Å–∏–ª—å–Ω–µ–µ, –µ—Å–ª–∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª—è–ª–∏—Å—å ‚Äî –æ—Ç—Å—Ç—É–ø–∞–µ—Ç.'
            }
        };

        // –ú–∞—Ç—Ä–∏—Ü—ã –≤—ã–∏–≥—Ä—ã—à–µ–π –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
        const outcomeMatrices = {
            // Tit-for-Tat –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
            'tit-for-tat_always-betray': {
                'cooperate': {
                    'cooperate': { progress: 15, pleasureLong: 10, pleasureShort: 0, stress: -5 },
                    'betray': { progress: 5, pleasureLong: 5, pleasureShort: 0, stress: 10 }
                },
                'betray': {
                    'cooperate': { progress: -5, pleasureLong: 0, pleasureShort: 20, stress: 5 },
                    'betray': { progress: -10, pleasureLong: 0, pleasureShort: 15, stress: 15 }
                }
            },
            'tit-for-tat_random': {
                'cooperate': {
                    'cooperate': { progress: 12, pleasureLong: 8, pleasureShort: 0, stress: -3 },
                    'betray': { progress: 3, pleasureLong: 3, pleasureShort: 0, stress: 12 }
                },
                'betray': {
                    'cooperate': { progress: -3, pleasureLong: 0, pleasureShort: 18, stress: 8 },
                    'betray': { progress: -8, pleasureLong: 0, pleasureShort: 12, stress: 18 }
                }
            },
            'tit-for-tat_pavlov': {
                'cooperate': {
                    'cooperate': { progress: 18, pleasureLong: 12, pleasureShort: 0, stress: -8 },
                    'betray': { progress: 8, pleasureLong: 8, pleasureShort: 0, stress: 15 }
                },
                'betray': {
                    'cooperate': { progress: -8, pleasureLong: 0, pleasureShort: 25, stress: 10 },
                    'betray': { progress: -15, pleasureLong: 0, pleasureShort: 20, stress: 25 }
                }
            },
            // Grudger –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
            'grudger_always-betray': {
                'cooperate': {
                    'cooperate': { progress: 20, pleasureLong: 15, pleasureShort: 0, stress: -10 },
                    'betray': { progress: 0, pleasureLong: 5, pleasureShort: 0, stress: 20 }
                },
                'betray': {
                    'cooperate': { progress: -10, pleasureLong: 0, pleasureShort: 25, stress: 10 },
                    'betray': { progress: -20, pleasureLong: 0, pleasureShort: 20, stress: 30 }
                }
            },
            'grudger_random': {
                'cooperate': {
                    'cooperate': { progress: 18, pleasureLong: 12, pleasureShort: 0, stress: -8 },
                    'betray': { progress: -2, pleasureLong: 3, pleasureShort: 0, stress: 18 }
                },
                'betray': {
                    'cooperate': { progress: -8, pleasureLong: 0, pleasureShort: 22, stress: 15 },
                    'betray': { progress: -18, pleasureLong: 0, pleasureShort: 18, stress: 28 }
                }
            },
            'grudger_pavlov': {
                'cooperate': {
                    'cooperate': { progress: 25, pleasureLong: 18, pleasureShort: 0, stress: -12 },
                    'betray': { progress: 5, pleasureLong: 8, pleasureShort: 0, stress: 25 }
                },
                'betray': {
                    'cooperate': { progress: -12, pleasureLong: 0, pleasureShort: 30, stress: 15 },
                    'betray': { progress: -25, pleasureLong: 0, pleasureShort: 25, stress: 35 }
                }
            }
        };

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const dayElement = document.getElementById('day');
        const currentDayElement = document.getElementById('current-day');
        const progressBar = document.getElementById('progress-bar');
        const progressValue = document.getElementById('progress-value');
        const pleasureLongBar = document.getElementById('pleasure-long-bar');
        const pleasureLongValue = document.getElementById('pleasure-long-value');
        const pleasureShortBar = document.getElementById('pleasure-short-bar');
        const pleasureShortValue = document.getElementById('pleasure-short-value');
        const stressBar = document.getElementById('stress-bar');
        const stressValue = document.getElementById('stress-value');
        const dayProgressBar = document.getElementById('day-progress-bar');
        const historyElement = document.getElementById('history');
        const wisdomStrategySelect = document.getElementById('wisdom-strategy');
        const subconsciousStrategySelect = document.getElementById('subconscious-strategy');
        const wisdomDescElement = document.getElementById('wisdom-desc');
        const subconsciousDescElement = document.getElementById('subconscious-desc');
        const cooperateButton = document.getElementById('cooperate');
        const betrayButton = document.getElementById('betray');
        const outcomeMatrixElement = document.getElementById('outcome-matrix');

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
        function getCurrentMatrix() {
            const key = `${gameState.wisdomStrategy}_${gameState.subconsciousStrategy}`;
            return outcomeMatrices[key] || outcomeMatrices['tit-for-tat_always-betray'];
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
        function updateUI() {
            dayElement.textContent = gameState.day;
            currentDayElement.textContent = gameState.day;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
            progressValue.textContent = Math.max(0, gameState.progress);
            pleasureLongValue.textContent = Math.max(0, gameState.pleasureLong);
            pleasureShortValue.textContent = Math.max(0, gameState.pleasureShort);
            stressValue.textContent = Math.max(0, gameState.stress);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã
            progressBar.style.width = `${Math.min(100, Math.max(0, gameState.progress))}%`;
            pleasureLongBar.style.width = `${Math.min(100, Math.max(0, gameState.pleasureLong))}%`;
            pleasureShortBar.style.width = `${Math.min(100, Math.max(0, gameState.pleasureShort))}%`;
            stressBar.style.width = `${Math.min(100, Math.max(0, gameState.stress))}%`;
            
            dayProgressBar.style.width = `${(gameState.day / gameState.maxDays) * 100}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
            wisdomDescElement.textContent = strategyDescriptions.wisdom[gameState.wisdomStrategy];
            subconsciousDescElement.textContent = strategyDescriptions.subconscious[gameState.subconsciousStrategy];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞—Ç—Ä–∏—Ü—É –≤—ã–∏–≥—Ä—ã—à–µ–π
            updateOutcomeMatrix();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
            if (gameState.day > gameState.maxDays) {
                endGame();
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –≤—ã–∏–≥—Ä—ã—à–µ–π
        function updateOutcomeMatrix() {
            const matrix = getCurrentMatrix();
            
            outcomeMatrixElement.innerHTML = `
                <tr>
                    <th>–í–∞—à –≤—ã–±–æ—Ä \ –ê–≥–µ–Ω—Ç</th>
                    <th>–°–æ—Ç—Ä—É–¥–Ω–∏—á–∞–µ—Ç</th>
                    <th>–ü—Ä–µ–¥–∞–µ—Ç</th>
                </tr>
                <tr>
                    <td><strong>–£—á–µ–±–∞</strong></td>
                    <td>
                        –ü—Ä–æ–≥—Ä–µ—Å—Å: +${matrix.cooperate.cooperate.progress}<br>
                        –£–¥–æ–≤. (–¥–æ–ª–≥.): +${matrix.cooperate.cooperate.pleasureLong}<br>
                        –°—Ç—Ä–µ—Å—Å: ${matrix.cooperate.cooperate.stress > 0 ? '+' : ''}${matrix.cooperate.cooperate.stress}
                    </td>
                    <td>
                        –ü—Ä–æ–≥—Ä–µ—Å—Å: +${matrix.cooperate.betray.progress}<br>
                        –£–¥–æ–≤. (–¥–æ–ª–≥.): +${matrix.cooperate.betray.pleasureLong}<br>
                        –°—Ç—Ä–µ—Å—Å: +${matrix.cooperate.betray.stress}
                    </td>
                </tr>
                <tr>
                    <td><strong>–õ–µ–Ω—å</strong></td>
                    <td>
                        –£–¥–æ–≤. (–∫—Ä–∞—Ç–∫.): +${matrix.betray.cooperate.pleasureShort}<br>
                        –°—Ç—Ä–µ—Å—Å: +${matrix.betray.cooperate.stress}
                    </td>
                    <td>
                        –£–¥–æ–≤. (–∫—Ä–∞—Ç–∫.): +${matrix.betray.betray.pleasureShort}<br>
                        –°—Ç—Ä–µ—Å—Å: +${matrix.betray.betray.stress}
                    </td>
                </tr>
            `;
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –∏—Å—Ç–æ—Ä–∏—é
        function addHistoryEntry(choice, wisdomAction, subconsciousAction, results) {
            const entry = document.createElement('div');
            entry.className = 'history-item';
            
            const choiceText = choice === 'cooperate' ? '–£—á–µ–±–∞' : '–õ–µ–Ω—å';
            const wisdomText = wisdomAction === 'cooperate' ? '–ø–æ–¥–¥–µ—Ä–∂–∞–ª–æ' : '–Ω–∞–∫–∞–∑–∞–ª–æ';
            const subconsciousText = subconsciousAction === 'cooperate' ? '–ø–æ–¥–¥–µ—Ä–∂–∞–ª–æ' : '—É–≥–æ–≤–∞—Ä–∏–≤–∞–ª–æ';
            
            entry.innerHTML = `
                <strong>–î–µ–Ω—å ${gameState.day}:</strong> ${choiceText}<br>
                –ë–ª–∞–≥–æ—Ä–∞–∑—É–º–∏–µ ${wisdomText}, –ü–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ ${subconsciousText}<br>
                ${results.progress !== 0 ? `–ü—Ä–æ–≥—Ä–µ—Å—Å ${results.progress > 0 ? '+' : ''}${results.progress} ` : ''}
                ${results.pleasureLong !== 0 ? `–£–¥–æ–≤. (–¥–æ–ª–≥.) ${results.pleasureLong > 0 ? '+' : ''}${results.pleasureLong} ` : ''}
                ${results.pleasureShort !== 0 ? `–£–¥–æ–≤. (–∫—Ä–∞—Ç–∫.) ${results.pleasureShort > 0 ? '+' : ''}${results.pleasureShort} ` : ''}
                ${results.stress !== 0 ? `–°—Ç—Ä–µ—Å—Å ${results.stress > 0 ? '+' : ''}${results.stress}` : ''}
            `;
            
            historyElement.prepend(entry);
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é 10 –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –∑–∞–ø–∏—Å—è–º–∏
            if (historyElement.children.length > 10) {
                historyElement.removeChild(historyElement.lastChild);
            }
        }

        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –∞–≥–µ–Ω—Ç–∞
        function getAgentAction(agent, choice) {
            if (agent === 'wisdom') {
                switch (gameState.wisdomStrategy) {
                    case 'tit-for-tat':
                        return gameState.lastChoice === null ? 'cooperate' : gameState.lastChoice;
                    case 'grudger':
                        if (gameState.hasBetrayed) return 'betray';
                        return choice === 'betray' ? (gameState.hasBetrayed = true, 'betray') : 'cooperate';
                }
            } else {
                switch (gameState.subconsciousStrategy) {
                    case 'always-betray':
                        return 'betray';
                    case 'random':
                        return Math.random() > 0.5 ? 'cooperate' : 'betray';
                    case 'pavlov':
                        if (gameState.lastChoice === null) return 'betray';
                        return choice === 'betray' ? 'betray' : 'cooperate';
                }
            }
            return 'cooperate';
        }

        // –†–∞—Å—á–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function calculateResults(choice, wisdomAction, subconsciousAction) {
            const matrix = getCurrentMatrix();
            return choice === 'cooperate' ? 
                matrix.cooperate[wisdomAction] : 
                matrix.betray[subconsciousAction];
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞
        function handleChoice(choice) {
            if (gameState.day > gameState.maxDays) return;
            
            gameState.lastChoice = choice;
            if (choice === 'betray') gameState.hasBetrayed = true;
            
            const wisdomAction = getAgentAction('wisdom', choice);
            const subconsciousAction = getAgentAction('subconscious', choice);
            
            const results = calculateResults(choice, wisdomAction, subconsciousAction);
            
            gameState.progress += results.progress || 0;
            gameState.pleasureLong += results.pleasureLong || 0;
            gameState.pleasureShort += results.pleasureShort || 0;
            gameState.stress += results.stress || 0;
            
            // –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ —É–π–¥—É—Ç –≤ –º–∏–Ω—É—Å
            gameState.progress = Math.max(0, gameState.progress);
            gameState.pleasureLong = Math.max(0, gameState.pleasureLong);
            gameState.pleasureShort = Math.max(0, gameState.pleasureShort);
            gameState.stress = Math.max(0, gameState.stress);
            
            addHistoryEntry(choice, wisdomAction, subconsciousAction, results);
            gameState.day++;
            updateUI();
        }

        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
        function endGame() {
            alert(`–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!\n\n–ò—Ç–æ–≥–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
                \n–ü—Ä–æ–≥—Ä–µ—Å—Å: ${gameState.progress}
                \n–£–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ (–¥–æ–ª–≥.): ${gameState.pleasureLong}
                \n–£–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ (–∫—Ä–∞—Ç–∫.): ${gameState.pleasureShort}
                \n–°—Ç—Ä–µ—Å—Å: ${gameState.stress}`);
            
            // –°–±—Ä–æ—Å –∏–≥—Ä—ã
            gameState.day = 1;
            gameState.progress = 20;
            gameState.pleasureLong = 10;
            gameState.pleasureShort = 30;
            gameState.stress = 20;
            gameState.lastChoice = null;
            gameState.hasBetrayed = false;
            gameState.history = [];
            historyElement.innerHTML = '';
            updateUI();
        }

        // –°–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π
        cooperateButton.addEventListener('click', () => handleChoice('cooperate'));
        betrayButton.addEventListener('click', () => handleChoice('betray'));
        
        wisdomStrategySelect.addEventListener('change', (e) => {
            gameState.wisdomStrategy = e.target.value;
            updateUI();
        });
        
        subconsciousStrategySelect.addEventListener('change', (e) => {
            gameState.subconsciousStrategy = e.target.value;
            updateUI();
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateUI();
    </script>
</body>
</html>